function cov_1jiig317dd(){var path="C:\\Users\\Ink\\Documents\\Project\\my-brand\\Backend\\authreq.js";var hash="9bd19f488ec473e769588641fc849433287682ca";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Ink\\Documents\\Project\\my-brand\\Backend\\authreq.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:2,column:13},end:{line:2,column:30}},"2":{start:{line:4,column:20},end:{line:21,column:1}},"3":{start:{line:5,column:16},end:{line:5,column:31}},"4":{start:{line:8,column:2},end:{line:20,column:3}},"5":{start:{line:9,column:4},end:{line:17,column:7}},"6":{start:{line:10,column:6},end:{line:16,column:7}},"7":{start:{line:11,column:8},end:{line:11,column:33}},"8":{start:{line:12,column:8},end:{line:12,column:31}},"9":{start:{line:14,column:8},end:{line:14,column:34}},"10":{start:{line:15,column:8},end:{line:15,column:15}},"11":{start:{line:19,column:4},end:{line:19,column:27}},"12":{start:{line:24,column:18},end:{line:41,column:1}},"13":{start:{line:25,column:16},end:{line:25,column:31}},"14":{start:{line:26,column:2},end:{line:40,column:3}},"15":{start:{line:27,column:4},end:{line:36,column:7}},"16":{start:{line:28,column:6},end:{line:35,column:7}},"17":{start:{line:29,column:8},end:{line:29,column:31}},"18":{start:{line:30,column:8},end:{line:30,column:15}},"19":{start:{line:32,column:19},end:{line:32,column:55}},"20":{start:{line:33,column:8},end:{line:33,column:31}},"21":{start:{line:34,column:8},end:{line:34,column:15}},"22":{start:{line:38,column:4},end:{line:38,column:27}},"23":{start:{line:39,column:4},end:{line:39,column:11}},"24":{start:{line:44,column:0},end:{line:44,column:44}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:20},end:{line:4,column:21}},loc:{start:{line:4,column:40},end:{line:21,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:33},end:{line:9,column:34}},loc:{start:{line:9,column:56},end:{line:17,column:5}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:18},end:{line:24,column:19}},loc:{start:{line:24,column:38},end:{line:41,column:1}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:27,column:33},end:{line:27,column:34}},loc:{start:{line:27,column:62},end:{line:36,column:5}},line:27}},branchMap:{"0":{loc:{start:{line:8,column:2},end:{line:20,column:3}},type:"if",locations:[{start:{line:8,column:2},end:{line:20,column:3}},{start:{line:8,column:2},end:{line:20,column:3}}],line:8},"1":{loc:{start:{line:10,column:6},end:{line:16,column:7}},type:"if",locations:[{start:{line:10,column:6},end:{line:16,column:7}},{start:{line:10,column:6},end:{line:16,column:7}}],line:10},"2":{loc:{start:{line:26,column:2},end:{line:40,column:3}},type:"if",locations:[{start:{line:26,column:2},end:{line:40,column:3}},{start:{line:26,column:2},end:{line:40,column:3}}],line:26},"3":{loc:{start:{line:28,column:6},end:{line:35,column:7}},type:"if",locations:[{start:{line:28,column:6},end:{line:35,column:7}},{start:{line:28,column:6},end:{line:35,column:7}}],line:28}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"9bd19f488ec473e769588641fc849433287682ca"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1jiig317dd=function(){return actualCoverage;};}return actualCoverage;}cov_1jiig317dd();const jwt=(cov_1jiig317dd().s[0]++,require('jsonwebtoken'));const User=(cov_1jiig317dd().s[1]++,require('./user'));cov_1jiig317dd().s[2]++;const requireAuth=(req,res,next)=>{cov_1jiig317dd().f[0]++;const token=(cov_1jiig317dd().s[3]++,req.cookies.jwt);// check json web token exists & is verified
cov_1jiig317dd().s[4]++;if(token){cov_1jiig317dd().b[0][0]++;cov_1jiig317dd().s[5]++;jwt.verify(token,'backend',(err,decodedToken)=>{cov_1jiig317dd().f[1]++;cov_1jiig317dd().s[6]++;if(err){cov_1jiig317dd().b[1][0]++;cov_1jiig317dd().s[7]++;console.log(err.message);cov_1jiig317dd().s[8]++;res.redirect('/login');}else{cov_1jiig317dd().b[1][1]++;cov_1jiig317dd().s[9]++;console.log(decodedToken);cov_1jiig317dd().s[10]++;next();}});}else{cov_1jiig317dd().b[0][1]++;cov_1jiig317dd().s[11]++;res.redirect('/login');}};// check current user
cov_1jiig317dd().s[12]++;const checkUser=(req,res,next)=>{cov_1jiig317dd().f[2]++;const token=(cov_1jiig317dd().s[13]++,req.cookies.jwt);cov_1jiig317dd().s[14]++;if(token){cov_1jiig317dd().b[2][0]++;cov_1jiig317dd().s[15]++;jwt.verify(token,'backend',async(err,decodedToken)=>{cov_1jiig317dd().f[3]++;cov_1jiig317dd().s[16]++;if(err){cov_1jiig317dd().b[3][0]++;cov_1jiig317dd().s[17]++;res.locals.user=null;cov_1jiig317dd().s[18]++;next();}else{cov_1jiig317dd().b[3][1]++;let user=(cov_1jiig317dd().s[19]++,await User.findById(decodedToken.id));cov_1jiig317dd().s[20]++;res.locals.user=user;cov_1jiig317dd().s[21]++;next();}});}else{cov_1jiig317dd().b[2][1]++;cov_1jiig317dd().s[22]++;res.locals.user=null;cov_1jiig317dd().s[23]++;next();}};cov_1jiig317dd().s[24]++;module.exports={requireAuth,checkUser};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiVXNlciIsInJlcXVpcmVBdXRoIiwicmVxIiwicmVzIiwibmV4dCIsInRva2VuIiwiY29va2llcyIsInZlcmlmeSIsImVyciIsImRlY29kZWRUb2tlbiIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlIiwicmVkaXJlY3QiLCJjaGVja1VzZXIiLCJsb2NhbHMiLCJ1c2VyIiwiZmluZEJ5SWQiLCJpZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJhdXRocmVxLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xyXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi91c2VyJyk7XHJcblxyXG5jb25zdCByZXF1aXJlQXV0aCA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGNvbnN0IHRva2VuID0gcmVxLmNvb2tpZXMuand0O1xyXG5cclxuICAvLyBjaGVjayBqc29uIHdlYiB0b2tlbiBleGlzdHMgJiBpcyB2ZXJpZmllZFxyXG4gIGlmICh0b2tlbikge1xyXG4gICAgand0LnZlcmlmeSh0b2tlbiwgJ2JhY2tlbmQnLCAoZXJyLCBkZWNvZGVkVG9rZW4pID0+IHtcclxuICAgICAgaWYgKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy9sb2dpbicpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRlY29kZWRUb2tlbik7XHJcbiAgICAgICAgbmV4dCgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmVzLnJlZGlyZWN0KCcvbG9naW4nKTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBjaGVjayBjdXJyZW50IHVzZXJcclxuY29uc3QgY2hlY2tVc2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy5qd3Q7XHJcbiAgaWYgKHRva2VuKSB7XHJcbiAgICBqd3QudmVyaWZ5KHRva2VuLCAnYmFja2VuZCcsIGFzeW5jIChlcnIsIGRlY29kZWRUb2tlbikgPT4ge1xyXG4gICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgcmVzLmxvY2Fscy51c2VyID0gbnVsbDtcclxuICAgICAgICBuZXh0KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKGRlY29kZWRUb2tlbi5pZCk7XHJcbiAgICAgICAgcmVzLmxvY2Fscy51c2VyID0gdXNlcjtcclxuICAgICAgICBuZXh0KCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXMubG9jYWxzLnVzZXIgPSBudWxsO1xyXG4gICAgbmV4dCgpO1xyXG4gIH1cclxufTtcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHsgcmVxdWlyZUF1dGgsIGNoZWNrVXNlciB9OyJdLCJtYXBwaW5ncyI6IjYrR0FlWTtBQUFBLDJGQWZaLEtBQU1BLElBQUcsMEJBQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUMsRUFDbkMsS0FBTUMsS0FBSSwwQkFBR0QsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFDLHdCQUUvQixLQUFNRSxZQUFXLENBQUcsQ0FBQ0MsR0FBRyxDQUFFQyxHQUFHLENBQUVDLElBQUksR0FBSyx5QkFDdEMsS0FBTUMsTUFBSywwQkFBR0gsR0FBRyxDQUFDSSxPQUFPLENBQUNSLEdBQUcsRUFFN0I7QUFBQSx3QkFDQSxHQUFJTyxLQUFLLENBQUUsb0RBQ1RQLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDRixLQUFLLENBQUUsU0FBUyxDQUFFLENBQUNHLEdBQUcsQ0FBRUMsWUFBWSxHQUFLLGlEQUNsRCxHQUFJRCxHQUFHLENBQUUsb0RBQ1BFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSCxHQUFHLENBQUNJLE9BQU8sQ0FBQyxDQUFDLHdCQUN6QlQsR0FBRyxDQUFDVSxRQUFRLENBQUMsUUFBUSxDQUFDLENBQ3hCLENBQUMsSUFBTSxvREFDTEgsT0FBTyxDQUFDQyxHQUFHLENBQUNGLFlBQVksQ0FBQyxDQUFDLHlCQUMxQkwsSUFBSSxFQUFFLENBQ1IsQ0FDRixDQUFDLENBQUMsQ0FDSixDQUFDLElBQU0scURBQ0xELEdBQUcsQ0FBQ1UsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUN4QixDQUNGLENBQUMsQ0FFRDtBQUFBLHlCQUNBLEtBQU1DLFVBQVMsQ0FBRyxDQUFDWixHQUFHLENBQUVDLEdBQUcsQ0FBRUMsSUFBSSxHQUFLLHlCQUNwQyxLQUFNQyxNQUFLLDJCQUFHSCxHQUFHLENBQUNJLE9BQU8sQ0FBQ1IsR0FBRyxFQUFDLHlCQUM5QixHQUFJTyxLQUFLLENBQUUscURBQ1RQLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDRixLQUFLLENBQUUsU0FBUyxDQUFFLE1BQU9HLEdBQUcsQ0FBRUMsWUFBWSxHQUFLLGtEQUN4RCxHQUFJRCxHQUFHLENBQUUscURBQ1BMLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDQyxJQUFJLENBQUcsSUFBSSxDQUFDLHlCQUN2QlosSUFBSSxFQUFFLENBQ1IsQ0FBQyxJQUFNLDRCQUNMLEdBQUlZLEtBQUksMkJBQUcsS0FBTWhCLEtBQUksQ0FBQ2lCLFFBQVEsQ0FBQ1IsWUFBWSxDQUFDUyxFQUFFLENBQUMsRUFBQyx5QkFDaERmLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDQyxJQUFJLENBQUdBLElBQUksQ0FBQyx5QkFDdkJaLElBQUksRUFBRSxDQUNSLENBQ0YsQ0FBQyxDQUFDLENBQ0osQ0FBQyxJQUFNLHFEQUNMRCxHQUFHLENBQUNZLE1BQU0sQ0FBQ0MsSUFBSSxDQUFHLElBQUksQ0FBQyx5QkFDdkJaLElBQUksRUFBRSxDQUNSLENBQ0YsQ0FBQyxDQUFDLHlCQUdGZSxNQUFNLENBQUNDLE9BQU8sQ0FBRyxDQUFFbkIsV0FBVyxDQUFFYSxTQUFVLENBQUMifQ==